<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PicoGPT</title>
    <link rel="stylesheet" href="https://use.typekit.net/upp3wws.css">
    <style>
        /* Base styles */
        body {
            font-family: "courier-std", monospace;
            margin: 0;
            padding: 0;
            background-color: #fff;
            color: #111;
            line-height: 1.6;
            font-size: 16px;
        }

        .container {
            max-width: 42rem;
            margin: 0 auto;
            padding: 2rem 1rem;
        }

        /* Typography */
        h1, h2, h3, .serif {
            font-family: Georgia, serif;
            font-weight: normal;
            line-height: 1.3;
            color: #000;
        }

        h1 {
            font-size: 2.5rem;
            margin: 1.5rem 0 1rem;
        }

        h2 {
            font-size: 2rem;
            margin: 2.5rem 0 1rem;
        }

        h3 {
            font-size: 1.5rem;
            margin: 2rem 0 0.75rem;
        }

        p {
            margin: 0 0 1.5rem;
        }

        /* Header and Navigation */
        header {
            border-bottom: 1px solid #eee;
            margin-bottom: 3rem;
            padding: 1rem 0;
        }

        .nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .nav-title {
            font-family: Georgia, serif;
            font-size: 1.25rem;
            color: #000;
            text-decoration: none;
        }

        .nav-links {
            display: flex;
            gap: 1.5rem;
        }

        .nav-links a {
            color: #111;
            text-decoration: none;
            border-bottom: 1px solid transparent;
            transition: border-color 0.2s;
        }

        .nav-links a:hover {
            border-bottom-color: #111;
        }

        /* Article Styling */
        .post-header {
            margin-bottom: 3rem;
        }

        .post-meta {
            font-size: 0.875rem;
            color: #666;
            margin: 0.5rem 0 2rem;
        }

        .post-content {
            margin-bottom: 4rem;
        }

        /* Code Blocks */
        pre {
            background-color: #f5f5f5;
            padding: 1rem;
            border-radius: 4px;
            overflow-x: auto;
            margin: 1.5rem 0;
        }

        code {
            font-family: "courier-std", monospace;
            font-size: 0.9em;
        }

        p code {
            background-color: #f5f5f5;
            padding: 0.2em 0.4em;
            border-radius: 3px;
        }

        /* Links */
        a {
            color: #111;
            text-decoration: underline;
            text-decoration-thickness: 1px;
            text-underline-offset: 0.2em;
        }

        a:hover {
            color: #444;
        }

        /* Back Link */
        .back-link {
            display: inline-block;
            margin-bottom: 2rem;
            color: #666;
            text-decoration: none;
        }

        .back-link:hover {
            color: #111;
        }

        /* Footer */
        footer {
            margin-top: 4rem;
            padding-top: 2rem;
            border-top: 1px solid #eee;
        }

        /* Images */
        img {
            max-width: 100%;
            height: auto;
            margin: 2rem 0;
            border-radius: 4px;
        }

        /* Responsive Design */
        @media (max-width: 600px) {
            body {
                font-size: 15px;
            }
            
            .container {
                padding: 1rem;
            }
            
            h1 {
                font-size: 2rem;
            }
            
            h2 {
                font-size: 1.75rem;
            }
            
            h3 {
                font-size: 1.25rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <nav class="nav">
                <a href="/" class="nav-title">rishi</a>
                <div class="nav-links">
                    <a href="/writings">Writings</a>
                </div>
            </nav>
        </header>

        <main>
            <article>
                <a href="/writings" class="back-link">← Back to writings</a>
                
                <header class="post-header">
                    <h1>PicoGPT (Part 1/n)</h1>
                    <div class="post-meta">
                        *10 min read
                    </div>
                </header>
                
                <div class="post-content">
                    <h2>Overview</h2>
                    <p>
                        I made PicoGPT as a way to do small experiments on gpt2 small sized architectures. Primarily this comes from experience; even top labs tend to do a lot of 1 8xH100 node experiments before scaling.
                    It is loosely based on the NanoGPT speedrun repository, but I removed some features I think would not scale well, as the purpose of PicoGPT was not speedrunning, but instead doing experiments to form theories on how to make better models at larger scales. 
                    This is not to say that certain architectural changes NanoGPT made won’t scale, but moreso that I didn’t have evidence of scaling, so I decided to keep the experimental repository simple. 
                    Also, if I were speedrunning, then that severely limits the types of experiments in the design space (for example, MoEs are out of the question for speedrunning due to communication overhead (2 gathers, scatter)). <br>
                    The initial PicoGPT experiments include: <br>
                    <br>

                    Multi-latent Attention <br>
                    Flex Attention <br>
                    Relu**2 <br>
                    RoPE <br>
                    feed forward MoEs with expert parallelism (experiment 2) <br>

                    I'll probably do many more experiments on this repo, the design space is huge. I often think about: [SSMs, hybrid models, parameter sharing], which readily fit into model experiments at this size. <br>
                    Things I did not include from NanoGPT:<br>
                    <br>
                    tanh logit soft capping (gemma)<br>
                    long short sliding window attention (gemma)<br>
                    QK norm<br>
                    encoder/decoder u-net architecture (nanoGPT)<br>
                    Muon optimizer<br>
                    Window warmup (it was found by NanoGPT that slowly increasing context length during training to max sped up training, intuitively I buy this, but didn’t include it)<br>
                    The initial architecture is slightly more sample efficient than gpt2 on 5B tokens of fineweb (did not do a full fineweb10B token run). It has a lot of room for growth of course.
                    </p>
                    
                    <h2>Initial Hypothesis</h2>
                    <p>
                        My initial idea was as follows. Multi latent attention is really interesting because of the parameter savings from low rank projections, as well as the inference compute savings of caching a low rank RoPE key tensor and a low rank joint kv embedding. I wanted to run some experiments to loosely benchmark the capabilities of this architectural change and see if I could potentially improve upon it at a smaller scale. <br>
                    Pretty much every other company to my knowledge was using context parallel instead of being able to run only data parallel for attention computation. Deepseek was already paying the cost of having many MoE’s with expert parallel. Potentially due to the low-rank nature of the key and value projections, it might be worthwhile to add MoE’s for added expressivity here.
                    
                    
                    </p>

                    <!-- Example code block -->
                    <pre><code>function example() {
    return "Hello World";
}</code></pre>
                </div>
            </article>
        </main>

        <footer>
            <p>© 2025 rishi</p>
        </footer>
    </div>
</body>
</html>